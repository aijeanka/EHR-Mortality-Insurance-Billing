<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aizhan Uteubayeva">
<meta name="dcterms.date" content="2023-09-18">

<title>HIDS6002: Homework 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="HW3_Aizhan_Uteubayeva_au198_files/libs/clipboard/clipboard.min.js"></script>
<script src="HW3_Aizhan_Uteubayeva_au198_files/libs/quarto-html/quarto.js"></script>
<script src="HW3_Aizhan_Uteubayeva_au198_files/libs/quarto-html/popper.min.js"></script>
<script src="HW3_Aizhan_Uteubayeva_au198_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HW3_Aizhan_Uteubayeva_au198_files/libs/quarto-html/anchor.min.js"></script>
<link href="HW3_Aizhan_Uteubayeva_au198_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HW3_Aizhan_Uteubayeva_au198_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HW3_Aizhan_Uteubayeva_au198_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HW3_Aizhan_Uteubayeva_au198_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HW3_Aizhan_Uteubayeva_au198_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">HIDS6002: Homework 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Aizhan Uteubayeva </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 18, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)     <span class="co"># loads the tidyverse tools</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RPostgres)     <span class="co"># loads the database driver for PostgreSQL</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(connections)   <span class="co"># helps RPostgres work with RStudio</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(keyring)       <span class="co"># access to a local encrypted keychain for passwords</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">connection_open</span>(RPostgres<span class="sc">::</span><span class="fu">Postgres</span>(),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">dbname =</span> <span class="st">"syntheticMGUH"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">host =</span> <span class="st">"34.85.177.140"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">user =</span> <span class="st">"hids502_student"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">password =</span> <span class="fu">key_get</span>(<span class="at">service =</span> <span class="st">"syntheticmguh"</span>, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">username =</span> <span class="st">"hids502_student"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="morbidity-and-mortality" class="level2">
<h2 class="anchored" data-anchor-id="morbidity-and-mortality">1) Morbidity and Mortality</h2>
<p>What are the top 3 causes of morbidity (illness) and the top 3 causes of mortality (death) in the US? In the Synthea data set, how would you estimate similar answers? (Hint - LOINC code ‘69453-9’ is ‘Cause of Death [US Standard Certificate of Death]’ and can be found in the <code>observations</code> table. Patients have encounters, which in turn have observations. This is where the cause of death is recorded. Illnesses can be found in the <code>conditions</code> table (i.e., diagnosis made a different encounters).</p>
<section id="mortality" class="level3">
<h3 class="anchored" data-anchor-id="mortality">Mortality</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">value</span>, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> mortality      </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> observations</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> code <span class="op">=</span> <span class="st">'69453-9'</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="fu">value</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> mortality <span class="kw">DESC</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">3</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>3 records</caption>
<colgroup>
<col style="width: 85%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">value</th>
<th style="text-align: right;">mortality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">End-stage renal disease (disorder)</td>
<td style="text-align: right;">618</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chronic congestive heart failure (disorder)</td>
<td style="text-align: right;">486</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Acute ST segment elevation myocardial infarction (disorder)</td>
<td style="text-align: right;">363</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Answer: According to the National Center for Health Statistics (NCHS), the top 3 causes of mortality in 2021 were hear disease, cancer and COVID-19 (“FastStats,” 2023). Using the code block for mortality, we have revealed that in the Synthea the top 3 causes of death are End-stage renal disease/disorder, chronic congestive heart failure/disorder and acute ST segment elevation myocardial infraction/disorder. Within the code we have not specified the year for the top causes, so we have counted all events starting from 2010 till 2023. The extrapolated data correlated to real-world data by including the types of heart disease, however in reality, the kidney disorder takes way below after respiratory diseases, diabetes, etc. We did not get cancer, as it should be desired.</p>
<p>Code explanation: In the code, I have retrieved the “value” column, which has the description of what is recorded, from <code>observations</code> tables; where I want to extract only the rows with matching code of <code>69453-9</code>. I have grouped it by <code>value</code> column in the descending order and limited the results to top three outcomes.</p>
</section>
<section id="morbidity" class="level3">
<h3 class="anchored" data-anchor-id="morbidity">Morbidity</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> description, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> morbidity</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> conditions</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> description </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> morbidity  <span class="kw">DESC</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">3</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>3 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">description</th>
<th style="text-align: right;">morbidity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Medication review due (situation)</td>
<td style="text-align: right;">441774</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stress (finding)</td>
<td style="text-align: right;">155529</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Full-time employment (finding)</td>
<td style="text-align: right;">137623</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>According to the Blue Cross and Blue Shields (BCBS) National Health Index conducted in 2021, the top impact-full illness that affect the wellness of patients are: major depressive disorder, hypertension and high cholesterol (“National Health Index | Blue Cross Blue Shield,” n.d.). The Synthea database has shown the most frequent events occurring in encounters. The refill of the medication is certainly one the most reasons for an appointment, however the code needs the improvement to reveal other causes.</p>
<p>Code explanation: In the code, I have retrieved the <code>description</code> column, which has the description of the condition, from <code>conditions</code> tables; where I want to count it in the descending order and limit to only top 3 rows.</p>
</section>
</section>
<section id="insurance" class="level2">
<h2 class="anchored" data-anchor-id="insurance">2) Insurance</h2>
<p>What is the breakdown of spending between Medicaid, Medicare and everything else in the US? Why do you think it might break down this way? In the Synthea data set, how would you estimate similar answers? (Hint: This will require you to look at the <code>encounters</code> table and join it against the <code>payers</code> table where you will find the names of the payers. You will likely find this easier to do for a single year, e.g 2022!.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> payer_name, <span class="fu">SUM</span>(payer_coverage) <span class="kw">AS</span> total_spent</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>(<span class="kw">SELECT</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">CASE</span> <span class="cf">WHEN</span> p.name <span class="kw">in</span> (<span class="st">'Medicare'</span>, <span class="st">'Medicaid'</span>) <span class="cf">THEN</span> p.name <span class="cf">ELSE</span> <span class="st">'Others'</span> <span class="cf">END</span> <span class="kw">AS</span> payer_name, e.payer_coverage</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> encounters e</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> payers p <span class="kw">ON</span> e.payer <span class="op">=</span> p.<span class="kw">id</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> e.<span class="kw">start</span> <span class="op">&gt;=</span> <span class="st">'2022-01-01 00:00:00'</span> <span class="kw">AND</span>  e.<span class="kw">stop</span> <span class="op">&lt;=</span> <span class="st">'2022-12-30 23:59:59'</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>) T</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> payer_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>3 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">payer_name</th>
<th style="text-align: right;">total_spent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Medicaid</td>
<td style="text-align: right;">259798886</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medicare</td>
<td style="text-align: right;">140562549</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Others</td>
<td style="text-align: right;">410705407</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Answer: According to the National Health Expenditure data from Centers for Medicare and Medicaid Services, in 2021 the total expenditure for Medicare estimated around 900.8 billion USD, meanwhile for the Medicaid the number reaches the approximate of 734.0 billion USD. The sample outcomes that we have derived from the Synthea for the 2022, do not reach such estimates due the smaller sample data of 57,000 patients. In addition the Medicaid is represented to have larges spent amount compared to the real world. It would be more accurate to investigate the amount spent per patient, per immunization or per prescription.</p>
<p>Code: In order to look into the spending breakdown, two major companies were extracted with the rest falling under the “others’. First, I have selected the <code>payer_name</code> adding up the total sum of <code>payer_coverage</code> (the sum paid for the patient by the insurance) and aliased as total_spent. The data to extract from was conditioned by the names”Medicare”,“Medicaid” with the <code>ELSE</code> falling into the “Others” category. Two tables were joined by <code>payers</code> in the <code>encounters</code> and <code>id</code> in the <code>payers</code>. The dates were set for the total spent in 2022 using the iso8601 UTC Date (yyyy-MM-dd’T’HH:mm’Z’) format, using the <code>start</code> and <code>stop</code> fields in the <code>encounters</code> table.</p>
</section>
<section id="lack-of-insurance" class="level2">
<h2 class="anchored" data-anchor-id="lack-of-insurance">3) Lack of Insurance</h2>
<p>What percent of Americans are estimated to be uninsured in the United States? How has this changed over the past 15 years, and why? In the Synthea data set, how would you estimate similar answers? (Hint - Every encounter in Synthea has a payer ID - there is actually an entry in the <code>payers</code> table for “No Insurance”, rather than the payer ID being NULL in the <code>encounters</code> table. Each encounter has insurance information associated with it, but if you want to know someone’s insurance status at any given time you need the ‘payer_transitions’ table which is a history of patient’s insurance coverage.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">with</span> total_patients_2010 <span class="kw">AS</span> (<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">id</span>) <span class="kw">AS</span> total_patients <span class="kw">FROM</span> patients),</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>total_patients_2023 <span class="kw">AS</span> (<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">id</span>) <span class="kw">AS</span> total_patients <span class="kw">FROM</span> patients <span class="kw">WHERE</span> deathdate <span class="kw">is</span>  <span class="kw">NULL</span>),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>uninsured_patients_2010 <span class="kw">AS</span> (<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> e.patient) <span class="kw">AS</span> uninsured_americans</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> encounters e</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> payers p <span class="kw">ON</span> e.payer <span class="op">=</span> p.<span class="kw">id</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> (e.<span class="kw">start</span> <span class="op">&gt;=</span> <span class="st">'2010-01-01 00:00:00'</span> <span class="kw">AND</span>  e.<span class="kw">stop</span> <span class="op">&lt;=</span> <span class="st">'2010-12-30 23:59:59'</span>) </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> p.name <span class="op">=</span> <span class="st">'NO_INSURANCE'</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>uninsured_patients_2023 <span class="kw">AS</span> (<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> e.patient) <span class="kw">AS</span> uninsured_americans</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> encounters e</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> payers p <span class="kw">ON</span> e.payer <span class="op">=</span> p.<span class="kw">id</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> (e.<span class="kw">start</span> <span class="op">&gt;=</span> <span class="st">'2023-01-01 00:00:00'</span> <span class="kw">AND</span> e.<span class="kw">stop</span> <span class="op">&lt;=</span> <span class="st">'2023-12-30 23:59:59'</span>) </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> p.name <span class="op">=</span> <span class="st">'NO_INSURANCE'</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>t3.uninsured_americans <span class="kw">AS</span> uninsured_2010 , t1.total_patients  <span class="kw">AS</span> total_patients_2010,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>t4.uninsured_americans <span class="kw">AS</span> uninsured_2023 , t2.total_patients <span class="kw">AS</span> total_aptient_2023</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>total_patients_2010 t1,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>total_patients_2023 t2,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>uninsured_patients_2010 t3,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>uninsured_patients_2023 t4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>1 records</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 28%">
<col style="width: 21%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">uninsured_2010</th>
<th style="text-align: right;">total_patients_2010</th>
<th style="text-align: right;">uninsured_2023</th>
<th style="text-align: right;">total_aptient_2023</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2749</td>
<td style="text-align: right;">57122</td>
<td style="text-align: right;">2173</td>
<td style="text-align: right;">50000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Answer: According to the NCHS 2023 report, 8.4% or 26.7 million Americans did not have health insurance in 2022 (Cohen, 2022). The number has decreased by two-fold compared to 2010 (“Products - NHIS Early Release - Health Insurance - 2010,” 2019), an Using Synthea, we have look at the earliest date (2010) and the latest (2023) available. The percentage is estimated by diving the uninsured/total_patients in a certain year. In 2010 4.8% of patients were uninsured, the number has dropped in 2023, estimating 4.3% of uninsured individuals.It might be that Synthea correlated with trend by the decreased number patients and does not have new patients, new subscriptions or rejection of the subscription was not mentioned in the code.</p>
<p>Code explanation: In order to answer the question, first, the total number of patients was retrieved for each year using the <code>SELECT COUNT</code> function from <code>patients</code> table. For the 2023, the number of dead patients was eliminates with the condition that <code>deathdate</code> is <code>NULL</code>. Secondly, the number of uninsured patients in 2023 was estimated by retrieving patient field from <code>encounters</code> table and <code>JOIN</code> the table by <code>payer=id</code> fields. The condition to choose persons with no insurance in <code>payers</code> table is set by <code>p.name = 'NO_INSURANCE'</code>. As well as the condition to choose the time in set format of iso8601 UTC Date (yyyy-MM-dd’T’HH:mm’Z’) using <code>start</code> and <code>stop</code> fields from encounters table. Thirdly, the selected values are from created at the beginning to output.</p>
</section>
<section id="surprise-billing" class="level2">
<h2 class="anchored" data-anchor-id="surprise-billing">Surprise Billing</h2>
<p>What is meant by “surprise billing” in the US? How common is this? What is the magnitude of surprise billing (eg, the range in prices billed)? How would you find evidence of this in the Synthea data set? Show whether it exists or does not exist in Synthea. (Hint - this is difficult, and you will get full points for any thoughtful attempt that runs. One way to think about it would to look for patients that appeared to have insurance the time of the encounter (<code>payer_transitions</code> table) but whose encounter was billed to <code>NO_INSURANCE</code>. Another would be to look for encounters where there was a valid payer but no-reimbursement by the payer (eg <code>payer_coverage</code> = 0), but this could also be just declined coverage!)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> patient)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>payer_transitions pt</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> payers p <span class="kw">ON</span> pt.payer <span class="op">=</span> p.<span class="kw">id</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> p.name <span class="op">=</span> <span class="st">'NO_INSURANCE'</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> patient <span class="kw">IN</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>(<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> patient</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>encounters e </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> payers p <span class="kw">ON</span> e.payer <span class="op">=</span> p.<span class="kw">id</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> p.name <span class="op">!=</span> <span class="st">'NO_INSURANCE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2939</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> patient) <span class="kw">AS</span> insured_patients</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>encounters e </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> payers p <span class="kw">ON</span> e.payer <span class="op">=</span> p.<span class="kw">id</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> p.name <span class="op">!=</span> <span class="st">'NO_INSURANCE'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">insured_patients</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">51337</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Answer: Surprise Medical Billings occur when the patient has an active insurance, the system has billed the patient for the encounter as if a person does not have it. In has been revealed that 40% of the US insured patients had received a surprise billing (Pollitz et al., 2020). The Synthea, however, has shown only 5% of the insured patients receiving the surprise billing.</p>
<p>Code Explanation: First, by joining the <code>payer_transitions</code> and <code>payers</code> table with the common key (<code>pt.payer = p.id</code>), the distinct patients were pulled <code>payer_transitions</code> table with billing to <code>NO_INSURANCE</code>, using <code>AND</code> we look that apparently the distinct patients from <code>encounters</code> <code>WHERE</code> they had insurance (<code>p.name != 'NO_INSURANCE'</code>). The intersection of both groups was counted. Second, the total of <code>insured_patients</code> was calculated by counting the distinct patients from <code>encounters</code> by matching with (<code>e.payer = p.id</code>), and condition with the name field not equal to <code>NO_INSURANCE</code>.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>Cohen, R.A., 2022. Health insurance coverage: Early release of estimates from the National Health Interview Survey, 2022. FastStats [WWW Document], 2023. URL https://www.cdc.gov/nchs/fastats/leading-causes-of-death.htm (accessed 9.17.23).</p>
<p>National Health Index | Blue Cross Blue Shield [WWW Document], n.d. URL https://www.bcbs.com/the-health-of-america/health-index/national-health-index (accessed 9.18.23).</p>
<p>NHE Fact Sheet | CMS [WWW Document], n.d. URL https://www.cms.gov/data-research/statistics-trends-and-reports/national-health-expenditure-data/nhe-fact-sheet (accessed 9.18.23).</p>
<p>Pollitz, K., Lopes, L., Kearney, A., Rae, M., Cox, C., Fehr, R., Rousseau, D., Kaiser Family Foundation, 2020. US Statistics on Surprise Medical Billing. JAMA 323, 498. https://doi.org/10.1001/jama.2020.0065</p>
<p>Products - NHIS Early Release - Health Insurance - 2010 [WWW Document], 2019. URL https://www.cdc.gov/nchs/data/nhis/earlyrelease/insur201106.htm (accessed 9.18.23).</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>